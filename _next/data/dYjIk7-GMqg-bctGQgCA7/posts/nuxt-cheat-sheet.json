{"pageProps":{"frontmatter":{"title":"Nuxt.js cheat sheet","description":"Nuxt.js development made easier.","date":"2019-05-21","slug":"/posts/nuxt-cheat-sheet","isPublished":true},"content":"\n<br>\n\n[Nuxt.js](https://nuxtjs.org/) is here to make your life easy, it's also here to make the Vue.js development process even nicer than it already is. But with all its good aspects, it has quirks that will have you click on every single link on Google.\n\nThis article is here to avoid these situations, it'll cover some normal use-cases and some edge-cases with quick and easy code snippets. It won't go into extreme detail on these matters, but will give you the documentation necessary to do so in case you want to.\n\n> Note: You'll need a good grasp of Vue.js concepts to take full advantage of this article !\n\nBefore we get into anything concrete, let me explain what Nuxt.js is.\n\n## What's Nuxt.js?\n\nNuxt.js is a framework based on [Vue.js](https://vuejs.org/) that allows you to build fully fledged [**server-rendered**](https://youtu.be/GQzn7XRdzxY?t=46) applications.\n\nIt comes out of the box with **loads** of useful packages:\n\n- 💻 Vue\n- ↩️ Vue Router (for easy routing)\n- 💾 Vuex (for easy state management)\n- 🏎 Vue Server Renderer (for server-side rendering out of the box)\n- 🕵️‍♂️ Vue meta (for SEO)\n\nHere's a list of what we'll cover (feel free to come back here if you're searching for something specific):\n\n### General\n\n- [Creating a Nuxt.js project](#creating-a-nuxtjs-project)\n- [Testing with Nuxt.js](#testing-with-nuxtjs)\n\n### Routing\n\n- [Creating a new route](#creating-a-new-route)\n- [Creating dynamic routes](#creating-dynamic-routes)\n- [Navigating to a route in a component template](#navigating-to-a-route-in-a-component-template)\n- [Navigating to a route programatically](#navigating-to-a-route-programatically)\n\n### State management\n\n- [Creating a new store module](#updating-a-store-before-rendering-a-component)\n- [Updating a store before rendering a component](#updating-a-store-before-rendering-a-component)\n\n### SEO\n\n- [Changing a page's head properties dynamically](#changing-a-pages-head-properties-dynamically)\n- [SSR for dynamic routes](#ssr-for-dynamic-routes)\n\n### Miscellaneous\n\n- [Displaying a fixed component throughout your app](#displaying-a-fixed-component-throughout-your-app)\n- [Changing a project's router base](#changing-a-projects-router-base)\n- [Handling internationalization (i18n)](#handling-internationalization-i18n)\n- [Importing a font to your project](#importing-a-font-to-your-project)\n\n> If you have any other requests or want to add anything new, please feel free to hit me up on Twitter [@christo_kade](https://twitter.com/christo_kadehttps://twitter.com/christo_kade) !\n\n## Creating a Nuxt.js project\n\n```bash\nyarn create nuxt-app <project-name>\n```\n\nWhich will prompt you to answer some questions, including:\n\n- Choose between integrated server-side frameworks (None by default, Express, Koa etc.)\n- Choose features to install (PWA Support, Linter / Formatter, Prettier, Axios)\n- Choose your favorite UI framework (None by default, Bootstrap, Vuetify, Bulma etc.)\n- Choose your favorite testing framework (None, Jest, AVA)\n- The Nuxt mode you want (Universal or SPA, [more information](https://nuxtjs.org/guide#server-rendered-universal-ssr-))\n\nOnce done and your dependencies are installed:\n\n```bash\n$ cd <project-name>\n$ yarn dev\n```\n\n<br>\n\n[Documentation](https://nuxtjs.org/guide/installation)\n\n## Testing with Nuxt.js\n\nThe majority of your testing syntax will depend on the testing framework chosen during the project's creation.  \nOut of the box, Nuxt uses the `@vue/test-utils` package to render your components thanks to multiple methods such as `mount()`, `shallowMount()` and `render()`. You'll then be able to test that specific values have been displayed, that specific methods were called etc.\n\nNuxt will also make sure to set everything up for you, all you'll have to do is create your `*.spec.js` or `*.test.js` files and run the `yarn test` command.\n\nHere's a classic (and brief) example of unit testing for a Vue component in a Nuxt project:\n\n```js\nimport { shallowMount } from \"@vue/test-utils\";\nimport cmp from \"~/components/navbar/navbar\";\n\n// Mocking an icon displayed in my navbar\njest.mock(\"~/static/icons/svg/icon-menu.svg\", () => \"\");\n\ndescribe(\"Navbar component\", () => {\n  // We shallow mount the component while mocking some internal elements\n  // Most of the time, you'll have to mock context objects such as $store or $route in order to render your component whithout any errors\n  const wrapper = shallowMount(cmp, {\n    // Stubbing nuxt-links in the navbar\n    stubs: [\"nuxt-link\"],\n    mocks: {\n      \"nuxt-Link\": true,\n      // Mocking the $store context object\n      $store: {\n        state: {\n          locale: \"en\",\n        },\n      },\n      // Mocking the $route context object\n      $route: {\n        path: \"mockedPath\",\n      },\n    },\n  });\n\n  it(\"Snapshot testing\", () => {\n    expect(wrapper.html()).toMatchSnapshot();\n  });\n\n  describe(\"Components validation\", () => {\n    it(\"should return a valid component\", () => {\n      expect(wrapper.is(cmp)).toBe(true);\n    });\n  });\n\n  describe(\"Content validation\", () => {\n    it(\"should render the link's name\", () => {\n      expect(wrapper.html()).toContain(\"About\");\n    });\n\n    // ...\n  });\n});\n```\n\n<br>\n\n[Documentation](https://vue-test-utils.vuejs.org/)\n\n## Creating a new route\n\nIn the `/pages` folder, create a file, its name will be the name of the route.\n\nSo for example:\n\n```jsx\n// /pages/about.vue\n\n<template>\n  <main>\n    <h1>About page</h1>\n  <main/>\n</template>\n\n<script>\nexport default {}\n</script>\n\n<style></style>\n```\n\nNavigating to `localhost:3000/about` will display this component's content\n\n<br>\n\n[Documentation](https://nuxtjs.org/guide/views#pages)\n\n## Creating dynamic routes\n\nIn the `/pages` folder, create a directory and a file prefixed by an underscore.\n\nFor example, the following file tree:\n\n```bash\npages/\n--| users/\n-----| _id.vue\n--| index.vue\n```\n\nWill automatically generate the following router inside the `.nuxt` folder whenever you build your project:\n\n```js\nrouter: {\n  routes: [\n    {\n      name: \"index\",\n      path: \"/\",\n      component: \"pages/index.vue\",\n    },\n    {\n      name: \"users-id\",\n      path: \"/users/:id?\",\n      component: \"pages/users/_id.vue\",\n    },\n  ];\n}\n```\n\nYou can now navigate to `/users/:id`, with `id` being whatever value you need it to be.\n\nTo retrieve this value in your `_id.vue` component, just do the following:\n\n```js\n// $route is a Nuxt context object, more info: https://nuxtjs.org/api/context\nconst { id } = this.$route.params;\n```\n\n<br>\n\n[Documentation](https://nuxtjs.org/guide/routing#dynamic-routes), including nested routes and dynamic nested routes.\n\n## Navigating to a route in a component template\n\nInside of any of your components:\n\n```jsx\n// /components/example.vue\n\n// Clicking on this nuxt-link will navigate to the /pages/about.vue component\n// nuxt-link renders an <a> tag in your HTML\n<template>\n  <section>\n    <nuxt-link to=\"/about\">About</nuxt-link>\n  </section>\n</template>\n\n// ...\n```\n\n<br>\n\n[Documentation](https://nuxtjs.org/api/components-nuxt-link#the-lt-nuxt-link-gt-component)\n\n## Navigating to a route programatically\n\n```js\n// Will add a history entry to the stack\nthis.$router.push({\n  path: \"/about\",\n});\n\n// Will not\nthis.$router.replace({\n  path: \"/about\",\n});\n\n// Goes back one record\nthis.$router.go(-1);\n```\n\n<a name=\"new-store\"></a>\n\n## Creating a new store module\n\nIn the `/store` folder, each file is a Vuex module.\n\n```javascript\n// /store/todos.js\nexport const state = () => ({\n  list: [],\n});\n\nexport const mutations = {\n  add(state, text) {\n    state.list.push({\n      text: text,\n      done: false,\n    });\n  },\n  remove(state, { todo }) {\n    state.list.splice(state.list.indexOf(todo), 1);\n  },\n  toggle(state, todo) {\n    todo.done = !todo.done;\n  },\n};\n```\n\nEach module's mutations, actions & states are now available using the context object `$store`:\n\n```html\n// /components/todo.vue\n<template>\n  <ul>\n    <li v-for=\"todo in todos\">\n      <input type=\"checkbox\" :checked=\"todo.done\" @change=\"toggle(todo)\" />\n      <span>{{ todo.text }}</span>\n    </li>\n    <li>\n      <input placeholder=\"What needs to be done?\" @keyup.enter=\"addTodo\" />\n    </li>\n  </ul>\n</template>\n\n<script>\n  import { mapMutations } from \"vuex\";\n\n  export default {\n    computed: {\n      todos() {\n        return this.$store.state.todos.list; // highlight-line\n      },\n    },\n    methods: {\n      addTodo(e) {\n        this.$store.commit(\"todos/add\", e.target.value); // highlight-line\n        e.target.value = \"\";\n      },\n      ...mapMutations({\n        // highlight-line\n        toggle: \"todos/toggle\", // highlight-line\n      }), // highlight-line\n    },\n  };\n</script>\n```\n\n<br>\n\n[Documentation](https://nuxtjs.org/guide/vuex-store#codefund_ad)\n\n## Updating a store before rendering a component\n\nSometimes you need to fill up a given state variable before rendering a component, here's how:\n\n```jsx\n// In any component\n\nexport default {\n  // Called before rendering the component\n  fetch({ store, params }) {\n    return axios.get(\"https://dog.ceo/api/breeds/image/random\").then((res) => {\n      store.commit(\"setDog\", res.data.message);\n    });\n  },\n};\n```\n\n> Warning: You don't have access of the component instance through `this` inside fetch because it is called before initiating the component ([read more](https://nuxtjs.org/api/pages-fetch)).\n\n<br>\n\n[Documentation](https://nuxtjs.org/api/pages-fetch#the-fetch-method)\n\n## Changing a page's head properties dynamically\n\nFor SEO purposes, defining the page's title, description keywords etc. can be useful. Here's how you can do it programmatically:\n\n```js\n// In any component\nexport default {\n  head: {\n    title: \"Page title\",\n    meta: [\n      {\n        hid: \"description\",\n        name: \"description\",\n        content: \"Page description\",\n      },\n    ],\n    // ...\n  },\n};\n```\n\n> Info: To avoid duplicated meta tags when used in child component, set up an unique identifier with the hid key for your meta elements ([read more](https://nuxtjs.org/api/pages-head#the-head-method)).\n\n<br>\n\n[Documentation](https://nuxtjs.org/api/pages-fetch#the-fetch-method)\n\n## SSR for dynamic routes\n\nWhen running `nuxt generate`, the HTML file for your dynamic routes won't be generated by default.\n\nFor example, if you have an `about.vue` page and a `_id.vue` one, when running `nuxt generate`, the resulting `dist` folder will contain `/about/index.html` but won't generate anything for your dynamic `_id.vue`.\n\nThis can lead to your dynamic routes to be missed by crawlers, and therefore not referenced by search engines !\n\nHere's how you can generate them automacially:\n\n```js\n// nuxt.config.js\n\nmodule.exports = {\n  // ...\n\n  // dynamicRoutes could be a JSON file containing your dynamic routes\n  // or could be retrieved automatically based on the content of your /pages folder\n  generate: {\n    routes: () => {\n      return dynamicRoutes.map((route) => `/articles/${route}`);\n    },\n  },\n\n  // ...\n};\n```\n\n`nuxt generate` will now generate the HTML file for each dynamic route returned by the `generate` property.\n\n<br>\n\n[Documentation](https://nuxtjs.org/api/configuration-generate#the-generate-property)\n\n## Displaying a fixed component throughout your app\n\nSometimes you need to add a navbar or a footer that will be displayed no matter the current route.\n\nThere's a `/layout` folder that contains `default.vue` by default. This layout holds the `<nuxt/>` component that takes care of rendering the content of each one of your pages (see [Creating a new route](#new-route)).\n\nSimply modify that component to fit your needs, for example:\n\n```html\n<template>\n  <div>\n    <navbar />\n    <nuxt />\n    <footer />\n  </div>\n</template>\n\n<script>\n  import navbar from \"~/components/navbar/navbar\";\n  import footer from \"~/components/footer/footer\";\n\n  export default {\n    components: {\n      cmpNavbar,\n      cmpFooter,\n    },\n  };\n</script>\n```\n\n<br>\n\n[Documentation](https://nuxtjs.org/guide/views#layouts)\n\n## Changing a project's router base\n\nIn some cases, when for example you're deploying your project on Github Pages under `username/my-project`, you'll need to change the project's router base so that your assets are displayed correctly.\n\n```js\n// nuxt.config.js\n\n// Will change the router base to /my-project/ when DEPLOY_ENV equals GH_PAGES\nconst routerBase =\n  process.env.DEPLOY_ENV === \"GH_PAGES\"\n    ? {\n        router: {\n          base: \"/my-project/\",\n        },\n      }\n    : {\n        router: {\n          base: \"/\",\n        },\n      };\n\nmodule.exports = {\n  // ...\n  routerBase,\n  // ...\n};\n```\n\nAnd don't forget to change your `package.json` so that `nuxt.config.js` knows when you're building or generating for Github Pages.\n\n```js\n// package.json\n\n\"scripts\": {\n  \"build:gh-pages\": \"DEPLOY_ENV=GH_PAGES nuxt build\",\n  \"generate:gh-pages\": \"DEPLOY_ENV=GH_PAGES nuxt generate\"\n},\n```\n\n## Handling internationalization (i18n)\n\nStart by running `yarn add vue-i18n`\n\nCreate the following file:\n\n```js\n// /plugins/i18n.js\n\nimport Vue from \"vue\";\nimport VueI18n from \"vue-i18n\";\n\nVue.use(VueI18n);\n\nexport default ({ app, store }) => {\n  // Set i18n instance on app\n  // This way we can use it globally in our components\n  app.i18n = new VueI18n({\n    locale: store.state.locale,\n    fallbackLocale: \"fr\",\n    messages: {\n      // Add the supported languages here AND their associated content files\n      en: require(\"~/static/json/data-en.json\"),\n      fr: require(\"~/static/json/data-fr.json\"),\n    },\n  });\n};\n```\n\nAnd add the following line in your `nuxt.config.js` to inform it we're using that plugin:\n\n```js\nmodule.exports = {\n  // ...\n  plugins: [\"~/plugins/i18n.js\"],\n  // ...\n};\n```\n\nIn this example, the current locale is based on my store's content, which looks like so:\n\n```js\nexport const state = () => ({\n  locales: [\"en\", \"fr\"],\n  locale: \"fr\",\n});\n\nexport const mutations = {\n  setLanguage(state, locale) {\n    if (state.locales.indexOf(locale) !== -1) {\n      state.locale = locale;\n    }\n  },\n};\n```\n\nSo whenever we call `setLanguage`, the locale is automatically updated and the correct JSON file is loaded ! ✨\n\nYour file contents are now available throughout your application like so:\n\n```js\n// Here we access the 'users' array in our JSON file\nthis.$t(\"users\");\n```\n\n<br>\n\n[Documentation](https://nuxtjs.org/examples/i18n#codefund_ad)\n\n## Importing a font to your project\n\n```js\n// nuxt.config.js\n\nmodule.exports = {\n  /*\n   ** Headers of the page\n   */\n  head: {\n    // ...\n    link: [\n      {\n        rel: \"stylesheet\",\n        href: \"https://fonts.googleapis.com/css?family=Lato\",\n      },\n    ],\n  },\n\n  // ...\n};\n```\n\n## Wrapping up\n\nAlright, I believe that's enough for one article. I've covered lots of use-cases which hopefully will be useful to some of you.  \nIf you have any questions or want to add anything to this article, feel free to message me on Twitter [@christo_kade](https://twitter.com/christo_kade), and make sure to follow me to be informed of any new articles I write or fun discoveries related to Javascript & CSS 😄\n"},"__N_SSG":true}